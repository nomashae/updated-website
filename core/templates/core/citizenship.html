{% extends "core/base.html" %}

{% block title %}Citizenship | Nomashae{% endblock %}

{% block extra_head %}
<style>
    .citizenship-container { max-width: 900px; margin: 3rem auto; padding: 0 1rem; }
    .citizenship-form { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 2rem; box-shadow: var(--shadow); }
    .citizenship-form label { display: block; font-weight: 600; margin-bottom: 0.3rem; }
    .citizenship-form input[type="text"], .citizenship-form select { width: 100%; padding: 0.6rem 0.8rem; border-radius: 6px; border: 1px solid var(--border-color); margin-bottom: 1rem; background: var(--bg-color); color: var(--text-color); }
    .citizenship-badge-preview { margin-top: 2rem; }
</style>
{% endblock %}

{% block content %}
<main class="citizenship-container">
    <h2 class="section-title">Citizenship Badge</h2>

    {% if error %}
    <div class="card" style="border-left: 4px solid #C53D2B; margin-bottom: 1rem;">
        <p style="margin: 0; color: #C53D2B; font-weight: 600;">{{ error }}</p>
    </div>
    {% endif %}

    <form method="post" class="citizenship-form">
        {% csrf_token %}
        <label for="id_username">Username</label>
        <input id="id_username" type="text" name="username" required placeholder="Your airbender name" value="{{ username_value }}" />

        <label for="id_origin">Where do you come from?</label>
        <select id="id_origin" name="origin" required>
            <option value="">Select your place...</option>
            {% for value, label in origins %}
                <option value="{{ value }}"{% if origin_value == value %} selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>

        <button type="submit" class="action-btn" style="margin-top: 0.5rem;">Generate Badge</button>
    </form>

    {% if badge %}
    <div class="card citizenship-badge-preview">
        <h3>Generated Badge</h3>
        <p><strong>Username:</strong> {{ badge.username }}</p>
        <p><strong>Origin:</strong> {{ badge.origin }}</p>
        <img src="{% url 'citizenship_badge_image' badge.id %}" alt="Citizenship badge for {{ badge.username }}" style="max-width: 100%; height: auto; margin: 1rem 0;" />
        <p>Color 1: <code>{{ badge.color1_hex }}</code></p>
        <p>Color 2: <code>{{ badge.color2_hex }}</code></p>
    </div>
    {% endif %}
</main>
{% endblock %}
