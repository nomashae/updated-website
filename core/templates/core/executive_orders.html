{% extends "core/base.html" %}
{% load static markdown_extras %}

{% block title %}{{ tab_title|default:"Executive Orders | Nomashae" }}{% endblock %}

{% block extra_head %}
<style>
    .container {
        max-width: 800px;
        margin: 3rem auto;
        padding: 0 1.5rem;
    }

    h1 {
        text-align: center;
        color: var(--primary);
        margin-bottom: 3rem;
        font-size: 2.2rem;
        font-weight: 800;
        letter-spacing: -0.5px;
    }

    .decree-card {
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        padding: 2.5rem;
        margin-bottom: 2.5rem;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        border-left: 5px solid var(--primary);
        border-radius: 0 16px 16px 0;
    }

    .decree-title {
        font-size: 1.4rem;
        font-weight: 800;
        margin-bottom: 1.5rem;
        color: var(--text-color);
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--border-color);
        line-height: 1.3;
    }

    .definition {
        margin-bottom: 1.2rem;
        line-height: 1.8;
        font-size: 1.05rem;
    }

    .signature {
        text-align: right;
        margin-top: 2.5rem;
        font-style: italic;
        color: var(--primary);
        font-weight: 600;
        opacity: 0.9;
    }

    .back-link {
        color: var(--text-color);
        text-decoration: none;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.95rem;
    }

    .back-link:hover {
        color: var(--primary);
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <a href="{% url 'home' %}" class="back-link"
        style="margin-bottom: 1rem; display: inline-flex; align-items: center; gap: 8px;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
        </svg>
        <span id="back-link" data-edit-id="news.back_link">Back to Home</span>
    </a>
    <h1 id="page-title" data-edit-id="news.page_title">News:</h1>

    {% for pr in press_releases %}
    <div class="decree-card glass">
        {% if request.user.is_staff %}
        <a href="{% url 'admin:core_pressrelease_change' pr.id %}" target="_blank"
            style="float: right; text-decoration: none; font-size: 0.8rem; border: 1px solid var(--primary); padding: 4px 8px; border-radius: 4px; color: var(--primary);">Edit</a>
        {% endif %}
        {% if pr.is_pinned %}
        <div
            style="color: var(--primary); font-weight: bold; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 4px;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M16 12V4h1V2H7v2h1v8l-2 2v2h5v6l1 1 1-1v-6h5v-2l-2-2z" />
            </svg> Pinned
        </div>
        {% endif %}
        <div class="decree-title">{{ pr.title }}</div>
        {% if pr.image %}
        <img src="{{ pr.image.url }}" alt="{{ pr.title }}"
            style="max-width: 100%; height: auto; border-radius: 8px; margin-bottom: 1rem; object-fit: cover; max-height: 400px;">
        {% endif %}
        {% if pr.header %}
        <div class="definition" style="font-weight: 600; font-size: 1.1rem; margin-bottom: 1rem;">
            {{ pr.header|render_markdown }}
        </div>
        {% endif %}
        <div class="definition" style="margin-bottom: 1rem;">
            {{ pr.body|render_markdown }}
        </div>
        <div class="signature">
            {% if pr.published_at %}
            <p>{{ pr.published_at|date:"d.m.Y H:i" }}</p>
            {% endif %}
            {% if pr.footer %}
            <div style="margin-top: 0.5rem;">
                {{ pr.footer|render_markdown }}
            </div>
            {% endif %}
        </div>
    </div>
    {% empty %}
    <p>No press releases yet.</p>
    {% endfor %}

    <div class="decree-card glass">
        <div class="decree-title" id="order-title">Straw & Hole Classification</div>
        <p class="definition" id="hole-def"><strong>Hole:</strong> A void with a single opening.</p>
        <p class="definition" id="tunnel-def"><strong>Tunnel:</strong> A hole connecting two openings.</p>
        <p class="definition" id="straw-def"><strong>Straw:</strong> A tiny tunnel. Straw = Two holes connected.</p>
        <p id="conclusion" style="margin-top: 1.5rem; font-style: italic; opacity: 0.8;">"Every straw is a tunnel, every
            tunnel has two holes."</p>
        <div class="signature">Eftimij Novakovski</div>
    </div>
</div>
<script>
    const themes = ['fire', 'earth', 'water', 'air'];
    let currentIdx = parseInt(localStorage.getItem('themeIndex') || '0');
    document.body.classList.add('theme-' + themes[currentIdx]);

    const translations = {
        en: {
            "page-title": "Executive Orders",
            "back-link": "Back to Home",
            "order-title": "Straw & Hole Classification",
            "hole-def": "<strong>Hole:</strong> A void with a single opening.",
            "tunnel-def": "<strong>Tunnel:</strong> A hole connecting two openings.",
            "straw-def": "<strong>Straw:</strong> A tiny tunnel. Straw = Two holes connected.",
            "conclusion": '"Every straw is a tunnel, every tunnel has two holes."',
            "order-title-2": "Executive Order: Democratic Transition",
            "hole-def-2": "After a fair vote, DMN Nomashae is a Democratic MicroNation.",
            "straw-def-2": "Vote closed on 30.12.2025.",
            "footer-text": "&copy; 2025 Nomashae"
        },
        mfb: {
            "page-title": "Exek Ord",
            "back-link": "Bak tu Hom",
            "order-title": "Strau & Hol Klasif",
            "hole-def": "<strong>Hol:</strong> Voit uni op.",
            "tunnel-def": "<strong>Tunel:</strong> Hol konex du op.",
            "straw-def": "<strong>Strau:</strong> Min tunel. Strau = du hol konex.",
            "conclusion": '"Al strau es tunel, al tunel hav du hol."',
            "order-title-2": "Exek Ord: Demok Trans",
            "hole-def-2": "Aft vot, Nomashae es Demok Mikronesh.",
            "straw-def-2": "Vot klos 30.12.2025.",
            "footer-text": "&copy; 2025 Nomasha"
        }
    };

    const langSwitcher = document.getElementById('lang-switcher');
    let currentLang = 'en';

    langSwitcher.addEventListener('click', () => {
        currentLang = currentLang === 'en' ? 'mfb' : 'en';
        langSwitcher.textContent = currentLang === 'en' ? 'EN' : 'mFB';
        for (const id in translations[currentLang]) {
            const element = document.getElementById(id);
            if (element) element.innerHTML = translations[currentLang][id];
        }
    });
</script>
{% endblock %}